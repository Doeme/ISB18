\documentclass{scrartcl}
\usepackage[utf8]{inputenc}
\usepackage[british]{babel}
\usepackage[T1]{fontenc}

\parindent 0pt
\parskip 0.5em

\usepackage[backend=bibtex8]{biblatex}
\bibliography{Handin}

\title{Assignment 7}
\author{Jakob Wittmann\\Dominik Schmidt}
\date{\today}

\usepackage{hyperref}
\usepackage[all]{hypcap}
\hypersetup{pdfborder = {0 0 0}, colorlinks=true, allcolors=black, urlcolor=blue}
\usepackage[margin=2.5cm]{geometry}
\usepackage{booktabs}
\usepackage{array}
\setlength{\tabcolsep}{.3em}

\usepackage{float}
\usepackage[export]{adjustbox}
\usepackage{amsmath}
\usepackage{listings}
\lstset{basicstyle=\ttfamily,breaklines=true}
\def\dd{\mathrm{d}}
\def\ml{\mathrm{\frac{mmol}{h}}}

\usepackage{longtable}
\usepackage{xcolor}
\usepackage{tikz}

\usepackage{multicol}

\usepackage[shortlabels]{enumitem}
\setlist[enumerate]{label=\alph*), labelsep=*}

\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}

\usepackage{pgfplotstable,filecontents}
\pgfplotsset{compat=1.9}% supress warning

\usepackage{placeins}

\begin{document}
   \pgfplotstableset{
      begin table=\begin{longtable},
      end table=\end{longtable},
   }
\maketitle
\section{Growth coupling via knockouts}
   To create new mutants we knocked out genes to indirectly 'deactivate' reactions. We implemented the proposed algorithm in the handout.
   The proposed algorithm uses n nested loops to generate the set of possible combined knock outs from the set of the model's genes. This
   is basically the Cartesian product of the model's set of genes with it self in the n-th order. As it doesn't matter if gene A and gene B
   or gene B and gene A are knocked out we only consider combinations of n genes to reduce this set.
   
   \begin{figure}[h]
      \centering
      \begin{subfigure}{.49\textwidth}
         \centering
         \includegraphics[width=\linewidth]{q1_results/result_q1_acetate_wild_type.pdf}
         \caption{Wild type e. coli, optimized for acetate}
         \label{fig:acetate_wild_type}
      \end{subfigure}%
      \begin{subfigure}{.49\textwidth}
         \centering
         \includegraphics[width=\linewidth]{q1_results/result_q1_d-lactate_wild_type.pdf}
         \caption{Wild type e. coli, optimized for d-lactate}
         \label{fig:d-lactate_wild_type}
      \end{subfigure}
      \begin{subfigure}{.49\textwidth}
         \centering
         \includegraphics[width=\linewidth]{q1_results/result_q1_succinate_wild_type.pdf}
         \caption{Wild type e. coli, optimized for succinate}
         \label{fig:succinate_wild_type}
      \end{subfigure}
      \begin{subfigure}{.49\textwidth}
         \centering
         \includegraphics[width=\linewidth]{q1_results/result_q1_ethanol_wild_type.pdf}
         \caption{Wild type e. coli, optimized for ethanol}
         \label{fig:ethanol_wild_type}
      \end{subfigure}
      \caption{Results of the wild type e. coli model}
      \label{fig:results_wild_type}
   \end{figure}
   
   \pgfplotstabletypeset[
      col sep=comma,
      columns/Metabolite/.style={string type},
      every head row/.style={
         before row={\caption{Results of wild type e. coli}\\\toprule},
         after row=\midrule,},
      every last row/.style={
         after row=\bottomrule}
      ]{q1_results/result_q1_wild_type.csv}
   
   \begin{figure}[h]
      \centering
      \begin{subfigure}{.49\textwidth}
         \centering
         \includegraphics[width=\linewidth]{q1_results/result_q1_acetate_1.pdf}
         \caption{1st choice mutant for acetate production}
         \label{fig:acetate_mutant_1}
      \end{subfigure}%
      \begin{subfigure}{.49\textwidth}
         \centering
         \includegraphics[width=\linewidth]{q1_results/result_q1_acetate_2.pdf}
         \caption{2nd choice mutant for acetate production}
         \label{fig:acetate_mutant_2}
      \end{subfigure}
      \caption{Mutants optimized for acetate production}
      \label{fig:acetate_mutants}
   \end{figure}
   
   \pgfplotstabletypeset[
      col sep=comma,
      columns/genes/.style={string type},
      every head row/.style={
         before row={\caption{Results of mutants optimized for acetate production}\\\toprule},
         after row=\midrule,},
      every last row/.style={
         after row=\bottomrule}
      ]{q1_results/result_q1_acetate.csv}

   \begin{figure}[h]
      \centering
      \begin{subfigure}{.49\textwidth}
         \centering
         \includegraphics[width=\linewidth]{q1_results/result_q1_d-lactate_1.pdf}
         \caption{1st choice mutant for d-lactate production}
         \label{fig:d-lactate_mutant_1}
      \end{subfigure}%
      \begin{subfigure}{.49\textwidth}
         \centering
         \includegraphics[width=\linewidth]{q1_results/result_q1_d-lactate_2.pdf}
         \caption{2nd choice mutant for d-lactate production}
         \label{fig:d-lactate_mutant_2}
      \end{subfigure}
      \caption{Mutants optimized for d-lactate production}
      \label{fig:d-lactate_mutants}
   \end{figure}
   
   \pgfplotstabletypeset[
      col sep=comma,
      columns/genes/.style={string type},
      every head row/.style={
         before row={\caption{Results for mutants optimized for d-lactate production}\\\toprule},
         after row=\midrule,},
      every last row/.style={
         after row=\bottomrule}
      ]{q1_results/result_q1_d-lactate.csv}
      
   \begin{figure}[h]
      \centering
      \begin{subfigure}{.49\textwidth}
         \centering
         \includegraphics[width=\linewidth]{q1_results/result_q1_succinate_1.pdf}
         \caption{1st choice mutant for succinate production}
         \label{fig:succinate_mutant_1}
      \end{subfigure}%
      \begin{subfigure}{.49\textwidth}
         \centering
         \includegraphics[width=\linewidth]{q1_results/result_q1_succinate_2.pdf}
         \caption{2nd choice mutant for succinate production}
         \label{fig:succinate_mutant_2}
      \end{subfigure}
      \caption{Mutants optimized for succinate production}
      \label{fig:succinate_mutants}
   \end{figure}
   
   \pgfplotstabletypeset[
      col sep=comma,
      columns/genes/.style={string type},
      every head row/.style={
         before row={\caption{Results for mutants optimized for succinate production}\\\toprule},
         after row=\midrule,},
      every last row/.style={
         after row=\bottomrule}
      ]{q1_results/result_q1_succinate.csv}
      
   \begin{figure}[h]
      \centering
      \begin{subfigure}{.49\textwidth}
         \centering
         \includegraphics[width=\linewidth]{q1_results/result_q1_ethanol_1.pdf}
         \caption{1st choice mutant for ethanol production}
         \label{fig:ethanol_mutant_1}
      \end{subfigure}%
      \begin{subfigure}{.49\textwidth}
         \centering
         \includegraphics[width=\linewidth]{q1_results/result_q1_ethanol_2.pdf}
         \caption{2nd choice mutant for ethanol production}
         \label{fig:ethanol_mutant_2}
      \end{subfigure}
      \caption{Mutants optimized for ethanol production}
      \label{fig:ethanol_mutants}
   \end{figure}
   
   \pgfplotstabletypeset[
      col sep=comma,
      columns/genes/.style={string type},
      every head row/.style={
         before row={\caption{Results for mutants optimized for ethanol production}\\\toprule},
         after row=\midrule,},
      every last row/.style={
         after row=\bottomrule}
      ]{q1_results/result_q1_ethanol.csv}
      
   \FloatBarrier
      
\section{Production of a non-native compound}
	We consider the additional pathway in Figure \ref{fig:pathway} as suggested by \cite{BORODINA201557}.
	\begin{figure}[h]
		\centering
		\includegraphics[max width=\linewidth, max height=0.5\paperheight]{2/new_pathway.pdf}
		\caption{The pathway to be added}
		\label{fig:pathway}
	\end{figure}
	We require the following additional metabolites:
	\begin{itemize}
		\item Aspartate, asp\_c
		\item $\beta$-Alanine, ala\_c
		\item Malonic Semaldehyde (3-Oxopropanoate), oxo\_c
		\item 3HP, hpa\_c
		\item L-Glutamate, glu\_c
	\end{itemize}
	and the following additional reactions:
	\begin{center}
	\begin{tabular}{r@{$\;\rightarrow\;$}l}
		oaa\_c + glu\_c & asp\_c + akg\_c \\
		asp\_c & ala\_c + co2\_c\\
		ala\_c + akg\_c & oxo\_c + glu\_c\\
		oxo\_c + nadph\_c & hpa\_c + nadp\_c\\
		hpa\_c & hpa\_e
	\end{tabular}
	\end{center}
	\subsection{Results}
		\begin{enumerate}[i)]
			\item Aerobic conditions yield ($\mathrm{\frac{ex\_hpa}{ex\_glc}}$): 0.09823718127269748
			\item Anaerobic conditions yield ($\mathrm{\frac{ex\_hpa}{ex\_glc}}$): 0.02415015570973515

		\end{enumerate}
		The pathway is active, and produces HPA. Its phaseplane can be seen in Figure \ref{fig:phaseplane}
		\begin{figure}[h]
			\centering
			\includegraphics[max width=0.75\linewidth]{src/phaseplane.pdf}
			\caption{Phaseplane}
			\label{fig:phaseplane}
		\end{figure}
\section{Flux modulation}
	The flux modulation reveals the following ranges, with the non-overlapping ones coloured in red:
	\def\barplot#1#2{\tikz[baseline,x=0.02\linewidth,y=0.02\linewidth]{\begin{scope}[yshift=-0.25ex]\filldraw[thick, red]#1;\end{scope}\begin{scope}[yshift=0.25ex]\filldraw[thick, blue]#2;\end{scope} \path(-16.7,0) -- (29.15,0);\draw (0,-0.75ex) -- (0,0.75ex);}}
	\begin{longtable}{p{0.2\linewidth}p{0.8\linewidth}}
		\input{src/barplot.tex}
	\end{longtable}
	\printbibliography
\end{document}
